# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/memory-controllers/apple,mcc.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Apple SoC MCC memory controller performance controls

maintainers:
  - Hector Martin <marcan@marcan.st>

description: |
  Apple SoCs contain a multichannel memory controller that can have its
  configuration changed to adjust to changing performance requirements from
  the rest of the SoC. This node represents the controller and provides a
  power domain provider that downstream devices can use to adjust the memory
  controller performance level.

properties:
  compatible:
    items:
      - enum:
          - apple,t8103-mcc
      - const: apple,mcc

  reg:
    maxItems: 1

  "#power-domain-cells":
    const: 0

  operating-points-v2:
    $ref: /schemas/types.yaml#/definitions/phandle-array
    description:
      A reference to the OPP table describing the memory controller performance
      levels. Each OPP node should contain an `apple,memory-perf-config`
      property that contains the configuration values for that performance
      level.

  apple,num-channels:
    $ref: /schemas/types.yaml#/definitions/uint32
    description:
      The number of memory channels in use.

required:
  - compatible
  - reg
  - "#power-domain-cells"
  - operating-points-v2
  - apple,num-channels

additionalProperties: false

examples:
  # See clock/apple,cluster-clock.yaml for an example of downstream usage.
  - |
    mcc_opp: opp-table-2 {
        compatible = "operating-points-v2";

        mcc_lowperf: opp0 {
            opp-level = <0>;
            apple,memory-perf-config = <0x813057f 0x1800180>;
        };
        mcc_highperf: opp1 {
            opp-level = <1>;
            apple,memory-perf-config = <0x133 0x55555340>;
        };
    };
    soc {
        #address-cells = <2>;
        #size-cells = <2>;

        mcc: memory-controller@200200000 {
            compatible = "apple,t8103-mcc", "apple,mcc";
            #power-domain-cells = <0>;
            reg = <0x2 0x200000 0x0 0x200000>;
            operating-points-v2 = <&mcc_opp>;
            apple,num-channels = <8>;
        };
    };
